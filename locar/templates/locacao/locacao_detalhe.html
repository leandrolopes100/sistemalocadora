{% extends "base.html" %}
{% load humanize %}

{% block title %}Detalhes da Locação — Locadora{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto mt-10 space-y-10">

  <!-- Cabeçalho -->
  <header class="border-b pb-5">
    <h1 class="text-3xl font-bold text-slate-900 tracking-tight">Detalhes da Locação #{{ locacao.id }}</h1>
    <p class="text-slate-500 text-sm mt-1">Visualize todas as informações da locação e seus dados financeiros.</p>
  </header>

  <!-- GRID PRINCIPAL -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    
    <!-- CLIENTE -->
    <section class="bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-md transition p-6">
      <h2 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M5.121 17.804A9 9 0 1118.878 6.196 9 9 0 015.121 17.804z"/>
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0z"/>
        </svg>
        Cliente
      </h2>
      <div class="text-sm text-slate-700 space-y-2">
        <p><span class="font-medium">Nome:</span> {{ locacao.cliente.nome }}</p>
        <p><span class="font-medium">CPF:</span> {{ locacao.cliente.cpf|default:"-" }}</p>
        <p><span class="font-medium">Telefone:</span> {{ locacao.cliente.telefone|default:"-" }}</p>
        <p><span class="font-medium">Email:</span> {{ locacao.cliente.email|default:"-" }}</p>
        <p><span class="font-medium">Endereço:</span> {{ locacao.cliente.endereco|default:"-" }}</p>
      </div>
    </section>

    <!-- VEÍCULO -->
    <section class="bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-md transition p-6">
      <h2 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 13l1.5-4.5A1 1 0 015.5 7h13a1 1 0 01.95.684L21 13v5a1 1 0 01-1 1h-1a2 2 0 11-4 0H9a2 2 0 11-4 0H4a1 1 0 01-1-1v-5z"/>
        </svg>
        Veículo
      </h2>
      <div class="text-sm text-slate-700 space-y-2">
        <p><span class="font-medium">Modelo:</span> {{ locacao.veiculo.modelo }}</p>
        <p><span class="font-medium">Placa:</span> {{ locacao.veiculo.placa }}</p>
        <p><span class="font-medium">Status:</span>
          {% if locacao.veiculo.status == "disponível" %}
            <span class="px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-xs font-medium">Disponível</span>
          {% elif locacao.veiculo.status == "alugado" %}
            <span class="px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium">Alugado</span>
          {% elif locacao.veiculo.status == "manutencao" %}
            <span class="px-2 py-0.5 bg-orange-100 text-orange-700 rounded-full text-xs font-medium">Manutenção</span>
          {% else %}
            <span class="px-2 py-0.5 bg-gray-100 text-gray-700 rounded-full text-xs font-medium">Inativo</span>
          {% endif %}
        </p>
      </div>
    </section>
  </div>

  <!-- PERÍODO E VALORES -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    
    <!-- PERÍODO -->
    <section class="bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-md transition p-6">
      <h2 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3M16 7V3M3 11h18M5 21h14a2 2 0 002-2V9H3v10a2 2 0 002 2z"/>
        </svg>
        Período e Quilometragem
      </h2>
      <div class="text-sm text-slate-700 space-y-2">
        <p><span class="font-medium">Início:</span> {{ locacao.inicio|date:"d/m/Y H:i" }}</p>
        <p><span class="font-medium">Final Previsto:</span> {{ locacao.fim|date:"d/m/Y H:i" }}</p>
        <p><span class="font-medium">Dias de Locação:</span> {{ locacao.dias_locacao }}</p>
        <p><span class="font-medium">KM Inicial:</span> {{ locacao.km_inicio|intcomma }}</p>
        <p><span class="font-medium">KM Final:</span> {{ locacao.km_fim|default:"-"|intcomma }}</p>
      </div>
    </section>

    <!-- VALORES -->
    <section class="bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-md transition p-6">
      <h2 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-teal-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-4 0-4 8 0 8s4-8 0-8z"/>
        </svg>
        Valores
      </h2>
      <div class="text-sm text-slate-700 space-y-2">
          <p><span class="font-medium">Valor Total:</span> R$ {{ locacao.valor_total_locacao|floatformat:2 }}</p>
          <p><span class="font-medium">Valor Semanal:</span> R$ {{ locacao.valor_semanal|floatformat:2 }}</p>
          
          <p>
            <span class="font-medium">Caução:</span>
            R$ {{ locacao.caucao|floatformat:2 }}
            {% if locacao.caucao_status %}
              <span class="text-red-500 text-xs">({{ locacao.get_caucao_status_display }})</span>
            {% endif %}
          </p>

          <p><span class="font-medium">Forma de Pagamento:</span> {{ locacao.get_forma_pagamento_display }}</p>
          <p><span class="font-medium">Semanas Contratadas:</span> {{ locacao.quantidade_semanas }}</p>
      </div>
    </section>
  </div>

  <!-- DOCUMENTOS E OBSERVAÇÕES -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    <section class="bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-md transition p-6">
      <h2 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M7 8h10M7 12h4m1 8h-6a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v6"/>
        </svg>
        Documentos
      </h2>
      {% if locacao.documentos_locacao %}
        <a href="{{ locacao.documentos_locacao.url }}" target="_blank" class="text-blue-600 hover:text-blue-700 underline text-sm">Visualizar documento</a>
      {% else %}
        <p class="text-slate-500 text-sm">Nenhum documento anexado.</p>
      {% endif %}
    </section>

    <section class="bg-white rounded-2xl shadow-sm border border-slate-200 hover:shadow-md transition p-6">
      <h2 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-orange-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
        Observações
      </h2>
      <p class="text-slate-700 text-sm">{{ locacao.observacoes|default:"Nenhuma Observação" }}</p>
    </section>
  </div>

  <!-- AÇÕES -->
  <footer class="border-t pt-6 flex justify-end gap-3">
    <a href="{% url 'locacao_list' %}" 
       class="inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white bg-slate-600 hover:bg-slate-700 transition">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
      </svg>
      Voltar
    </a>

    {% if locacao.status != "encerrada" %}
    <a href="{% url 'locacao_encerrar' locacao.id %}" 
       class="inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white bg-amber-600 hover:bg-amber-700 transition">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
      </svg>
      Encerrar Locação
    </a>
    {% endif %}
  </footer>

</div>
{% endblock %}
